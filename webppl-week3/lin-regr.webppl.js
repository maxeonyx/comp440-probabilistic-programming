
// data generated with python/numpy
// slope = 3
// intercept = 6
// x = np.linspace(0, 10, 11) + np.random.normal(0, 0.3, 11)
// y = ( x * slope + intercept ) + np.random.normal(0, 4, 11)

var data_x = [ 0.        ,  0.1010101 ,  0.2020202 ,  0.3030303 ,  0.4040404 ,
        0.50505051,  0.60606061,  0.70707071,  0.80808081,  0.90909091,
        1.01010101,  1.11111111,  1.21212121,  1.31313131,  1.41414141,
        1.51515152,  1.61616162,  1.71717172,  1.81818182,  1.91919192,
        2.02020202,  2.12121212,  2.22222222,  2.32323232,  2.42424242,
        2.52525253,  2.62626263,  2.72727273,  2.82828283,  2.92929293,
        3.03030303,  3.13131313,  3.23232323,  3.33333333,  3.43434343,
        3.53535354,  3.63636364,  3.73737374,  3.83838384,  3.93939394,
        4.04040404,  4.14141414,  4.24242424,  4.34343434,  4.44444444,
        4.54545455,  4.64646465,  4.74747475,  4.84848485,  4.94949495,
        5.05050505,  5.15151515,  5.25252525,  5.35353535,  5.45454545,
        5.55555556,  5.65656566,  5.75757576,  5.85858586,  5.95959596,
        6.06060606,  6.16161616,  6.26262626,  6.36363636,  6.46464646,
        6.56565657,  6.66666667,  6.76767677,  6.86868687,  6.96969697,
        7.07070707,  7.17171717,  7.27272727,  7.37373737,  7.47474747,
        7.57575758,  7.67676768,  7.77777778,  7.87878788,  7.97979798,
        8.08080808,  8.18181818,  8.28282828,  8.38383838,  8.48484848,
        8.58585859,  8.68686869,  8.78787879,  8.88888889,  8.98989899,
        9.09090909,  9.19191919,  9.29292929,  9.39393939,  9.49494949,
        9.5959596 ,  9.6969697 ,  9.7979798 ,  9.8989899 , 10.        ];
var data_y = [ 8.73896186,  7.32877982, 11.25085357,  2.40722021,  4.14534026,
        9.23765386,  5.99401719,  2.64936899,  8.94477661, 13.50930689,
        0.75105915,  9.64497142, 11.92978527, 13.51899804, 11.01077169,
        8.70842098, 11.59769007, 16.36671487, 11.4360174 ,  8.69059952,
       13.013005  , 11.12072605, 13.88090002, 12.85949827, 14.89472026,
       12.68242775, 22.98935897,  7.21554377, 17.06747041, 16.67113476,
       12.82165664, 14.03966336, 20.53836637, 16.13788666, 12.31388451,
       17.78090644, 12.21106702, 14.4381981 , 20.8077289 , 16.85508364,
       21.54784916, 22.12138566, 22.93517676, 19.86774894, 17.7324251 ,
       18.74620292, 17.39885921, 21.54772302, 19.27360355, 25.69046929,
       19.51254497, 20.09842269, 19.68665212, 19.23689128, 23.18220572,
       20.54541943, 22.46531566, 23.86474834, 23.84836785, 18.88721392,
       26.75069528, 25.1178136 , 22.94300015, 24.50297344, 25.31287062,
       25.10542992, 22.6840404 , 21.59634879, 22.36289445, 23.97795177,
       25.56484139, 34.78310748, 29.99238838, 27.53164804, 22.00728207,
       26.03154602, 25.43858434, 18.73304126, 32.45675237, 32.25293181,
       30.93420891, 34.52086844, 32.09183541, 28.4650745 , 29.22036454,
       32.12775065, 32.73197903, 30.91669705, 30.59644647, 26.62557509,
       41.96383061, 33.75066606, 36.96991496, 29.21885927, 31.95333981,
       35.59849764, 35.64662304, 32.5035489 , 39.94630685, 22.5328321 ];

var likelihood = function (slope, intercept, x) {
  var mu = x*slope + intercept;
  var sigma = 4.0;
  return Gaussian({ mu: mu, sigma: sigma });
};

var linear_regression = function () {
 
    var slope = gaussian({ mu: 0.0, sigma: 10.0 });
    var intercept = gaussian({ mu: 0.0, sigma: 10.0 });
    
    var do_observe = function (x, y) {
        observe(likelihood(slope, intercept, x), y);
    };
    map2(do_observe, data_x, data_y);
    
    return slope;// {slope:slope, intercept:intercept};
};

viz.auto(Infer({method: 'MCMC', samples: 100000}, linear_regression));
